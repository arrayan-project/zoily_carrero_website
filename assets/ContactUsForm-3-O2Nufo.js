var H=Object.defineProperty,M=Object.defineProperties;var F=Object.getOwnPropertyDescriptors;var k=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var T=(t,r,e)=>r in t?H(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e,C=(t,r)=>{for(var e in r||(r={}))L.call(r,e)&&T(t,e,r[e]);if(k)for(var e of k(r))O.call(r,e)&&T(t,e,r[e]);return t},A=(t,r)=>M(t,F(r));var I=(t,r,e)=>new Promise((m,i)=>{var p=o=>{try{n(e.next(o))}catch(l){i(l)}},c=o=>{try{n(e.throw(o))}catch(l){i(l)}},n=o=>o.done?m(o.value):Promise.resolve(o.value).then(p,c);n((e=e.apply(t,r)).next())});import{k as s,r as d}from"./react-BZa0HTj3.js";import{u as z}from"./index-DxlQCrK5.js";import{R as B}from"./RevealWrapper-cD3DO88r.js";import{R as J}from"./recaptcha-DZzlJA-T.js";const E=({type:t,id:r,label:e,rows:m,value:i,onChange:p,error:c})=>{const{theme:n}=z(),o=h=>h==="dark"?"text-white":"text-gray-700",l=h=>h==="dark"?"bg-gray-700 border-gray-700 text-white":"bg-white border-gray-300 text-gray-700",j=c?"border-red-500":"",g=h=>{p&&p(r,h.target.value)};return s.jsxs("div",{children:[s.jsx("label",{htmlFor:r,className:`block text-sm font-cinzel ${o(n)} mb-2`,children:e}),t==="textarea"?s.jsx("textarea",{id:r,rows:m,value:i,onChange:g,className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-200 ${l(n)} ${j}`}):s.jsx("input",{type:t,id:r,value:i,onChange:g,className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-200 ${l(n)} ${j}`}),c&&s.jsx("p",{className:"text-red-500 text-sm",children:c})]})},Q=()=>{const[t,r]=d.useState({name:"",email:"",subject:"",message:""}),[e,m]=d.useState({}),[i,p]=d.useState(!1),[c,n]=d.useState(""),[o,l]=d.useState(null),[j,g]=d.useState(!1),[h,N]=d.useState(!1),S=d.useRef(null),$="6LfyCh4rAAAAADBID5j6l-lRPoHDZTAhDlVEjrEM",D=()=>{if(h)return;if(window.grecaptcha){console.log("✅ reCAPTCHA ya estaba cacheado"),g(!0),N(!0);return}if(document.querySelector('script[src^="https://www.google.com/recaptcha/api.js"]'))console.log("✅ reCAPTCHA script ya estaba cargado (otra instancia)"),g(!0);else{const a=document.createElement("script");a.src="https://www.google.com/recaptcha/api.js?render=explicit",a.async=!0,a.defer=!0,a.onload=()=>{console.log("✅ reCAPTCHA script cargado dinámicamente"),g(!0)},document.body.appendChild(a)}N(!0)},w=(f,a)=>{const u=f;r(x=>A(C({},x),{[u]:a})),e[u]&&m(x=>{const y=C({},x);return delete y[u],y}),c&&n(""),j||D()},P=f=>{l(f),e.recaptcha&&f&&m(a=>{const u=C({},a);return delete u.recaptcha,u})},q=f=>I(void 0,null,function*(){var u,x,y,R;f.preventDefault(),n("");let a={};if(t.name||(a.name="El nombre es requerido"),t.email?/\S+@\S+\.\S+/.test(t.email)||(a.email="El correo no tiene un formato válido"):a.email="El email es requerido",t.subject||(a.subject="El tema es requerido"),t.message||(a.message="El mensaje es requerido"),o||(a.recaptcha="Por favor, verifica que no eres un robot."),m(a),!(Object.keys(a).length>0)){p(!0);try{const b=A(C({},t),{recaptchaToken:o}),v=yield(yield fetch("https://sendcontactform-tca7mefsba-uc.a.run.app",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)})).json();n((v==null?void 0:v.message)||"¡Mensaje enviado con éxito!"),r({name:"",email:"",subject:"",message:""}),m({}),(u=S.current)==null||u.reset(),l(null)}catch(b){console.error("Error al enviar el formulario: ",b),n(((y=(x=b==null?void 0:b.response)==null?void 0:x.data)==null?void 0:y.message)||"Hubo un error al enviar el formulario. Intenta de nuevo."),(R=S.current)==null||R.reset(),l(null)}finally{p(!1)}}});return s.jsx(B,{animationClass:"fade-in-animation",children:s.jsxs("form",{onSubmit:q,className:"space-y-6",children:[s.jsx(E,{type:"text",id:"name",label:"Nombre",value:t.name,onChange:w,error:e.name}),s.jsx(E,{type:"email",id:"email",label:"Email",value:t.email,onChange:w,error:e.email}),s.jsx(E,{type:"text",id:"subject",label:"Tema",value:t.subject,onChange:w,error:e.subject}),s.jsx(E,{type:"textarea",id:"message",label:"Mensaje",rows:4,value:t.message,onChange:w,error:e.message}),s.jsx("div",{className:"flex justify-center items-center my-4 min-h-[78px]",children:j?s.jsx(J,{ref:S,sitekey:$,onChange:P}):s.jsx("div",{className:"relative w-8 h-8",children:s.jsx("div",{className:"absolute w-full h-full border-4 border-pink-600 border-t-transparent rounded-full animate-spin"})})}),e.recaptcha&&s.jsx("p",{className:"text-red-500 text-sm text-center -mt-2 mb-4",children:e.recaptcha}),s.jsx("button",{type:"submit",disabled:i,className:`w-full px-6 py-3 bg-pink-600 text-white rounded-lg hover:bg-pink-700 transition-colors font-cinzel tracking-wider ${i?"opacity-50 cursor-not-allowed":""}`,children:i?"Enviando...":"ENVIAR MENSAJE"}),c&&s.jsx("p",{className:`text-sm text-center mt-4 ${c.includes("error")?"text-red-500":"text-green-600"}`,children:c})]})})};export{Q as C};
